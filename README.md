# Hybrid Fracture Analysis System

Welcome to the **Hybrid Fracture Analysis System**. This tool uses Artificial Intelligence (AI) to look at X-ray images and tell you if a bone is broken (fractured) and how bad the break is.

## ğŸ§  How the "Brain" Works

This system isn't just a simple AI; it's a "Hybrid" because it thinks in two different ways at the same time, like getting a second opinion instantly.

1. **The Pattern Recognizer (CNN)**:
   - Think of this as the "Intuition". It uses a Deep Learning model (ResNet50) that has looked at thousands of X-rays to learn what a fracture generally looks like.
   - It gives a quick Yes/No answer: "Is there a fracture?"

2. **The Detail Checker (Morphological Analysis)**:
   - Think of this as the "Ruler". It looks at the specific texture and edges of the bone.
   - It uses **Hough Transform** mathematics to find straight lines (edges of the bone) and measures the physical gap between them in pixels.

3. **The Judge (Rule-Based Logic)**:
   - It takes the answers from both the Pattern Recognizer and the Ruler to make a final decision based on medical rules:
     - **Gap > 2mm?** -> Severe Case (Surgery likely).
     - **Gap < 1mm?** -> Hairline Fracture (Cast might be enough).
     - **No gap but pattern?** -> Simple Displaced.

---

## ğŸ› ï¸ Installation & Setup (For Beginners)

### Prerequisites

You need to have **Python** installed on your computer.

1. **Install Python**: Download from [python.org](https://www.python.org/).
2. **Install Dependencies**: Open your terminal (Command Prompt) and run the following command to install the necessary "brain" libraries:

   ```bash
   pip install torch torchvision opencv-python numpy scikit-image pillow
   ```

---

## ğŸ« How to Train the Brain

Before the system can work, you need to teach it using your own X-ray images.

### Step 1: Prepare Your Folder

Create a folder named `data` inside this project directory. Inside it, you need two folders: `train` (mostly for learning) and `val` (for testing its knowledge), and inside those, separate folders for `Fracture` and `Normal` X-rays.

Your structure should look **exactly** like this:

```text
Project/
â”œâ”€â”€ src/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ Fracture/  <-- Put actual broken bone images here
â”‚   â”‚   â””â”€â”€ Normal/    <-- Put healthy bone images here
â”‚   â””â”€â”€ val/
â”‚       â”œâ”€â”€ Fracture/  <-- Put a few broken bone images here
â”‚       â””â”€â”€ Normal/    <-- Put a few healthy bone images here
```

### Step 2: Run the Training Command

Open your terminal and type:

```bash
python src/train.py
```

**What happens next?**

- The system will start reading your images.
- It will run for several "Epochs" (rounds of studying).
- Once finished, it saves its knowledge into a file called `fracture_model_best.pth`. This is the "trained brain."

---

## ğŸš€ How to Use It (Inference)

Once you have the `fracture_model_best.pth` file (either generated by you or provided), you can analyze multiple X-rays at once.

1.  **Prepare Input**: Create a folder `data/inference_input` and put your X-ray images inside it.
2.  **Run the System**:
    ```bash
    python src/main.py
    ```
3.  **Get Results**: The system will process all images and save individual result text files in `data/inference_results`.
    *   Example: `data/inference_results/patient1_result.txt` containing the diagnosis and severity metrics.

---

## â˜ï¸ Deployment

If you want to put this system on the internet or a hospital server:

1. **Cloud Hosting**: You can rent a GPU server (like AWS EC2 or Google Cloud Compute Engine) which makes the analysis very fast.
2. **Docker**: We can package this entire system into a "box" (Container) so it runs on any computer without installation issues.
   - *Create a `Dockerfile` that installs Python and the libraries listed above.*
   - *Copy your `src` folder and the `fracture_model_best.pth` into it.*
3. **API**: Wrap `src/main.py` with a web framework like Flask or FastAPI so doctors can upload images from a web page.

---

## â“ Troubleshooting

- **"No module named..."**: You forgot to run the `pip install` command.
- **"Dataset directory not found"**: Check that your `data` folder is named exactly `data` and is in the main project folder, not inside `src`.
